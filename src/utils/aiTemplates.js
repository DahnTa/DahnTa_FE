// AI ë¶„ì„ í…œí”Œë¦¿ - Gemini API ëŒ€ì²´
export const generateAIAnalysis = (persona, stockName, changeRate, recentPrices) => {
  const templates = {
    trend: {
      positive_high: `ðŸš€ ì§€ê¸ˆì´ ë°”ë¡œ ${stockName}ì— ì˜¬ë¼íƒˆ ì ˆí˜¸ì˜ ê¸°íšŒìž…ë‹ˆë‹¤!\n\ní˜„ìž¬ ìƒí™©: ê°•ë ¥í•œ ìƒìŠ¹ ëª¨ë©˜í…€ì´ í¬ì°©ë˜ì—ˆìŠµë‹ˆë‹¤. ${Math.abs(changeRate).toFixed(2)}%ì˜ ìƒìŠ¹ì€ ì‹œìž‘ì— ë¶ˆê³¼í•©ë‹ˆë‹¤.\n\nì¶”ì²œ: ê°•ë ¥ ë§¤ìˆ˜ ðŸ”¥\n\nêµ¬ì²´ì  ì¡°ì–¸: ì¶”ì„¸ëŠ” ì¹œêµ¬ìž…ë‹ˆë‹¤! ì´ ê¸°ì„¸ë¥¼ ë†“ì¹˜ì§€ ë§ˆì„¸ìš”. ëŠ¦ìœ¼ë©´ í›„íšŒí•©ë‹ˆë‹¤. ì§€ê¸ˆ ë‹¹ìž¥ í¬ì§€ì…˜ì„ ìž¡ìœ¼ì„¸ìš”!`,
      positive_low: `ðŸ“ˆ ${stockName}ì˜ ìƒìŠ¹ì„¸ê°€ ì¡°ê¸ˆì”© ë³´ì´ê¸° ì‹œìž‘í•˜ë„¤ìš”.\n\ní˜„ìž¬ ìƒí™©: ${Math.abs(changeRate).toFixed(2)}%ì˜ ì™„ë§Œí•œ ìƒìŠ¹ íë¦„ì´ ê°ì§€ë©ë‹ˆë‹¤.\n\nì¶”ì²œ: ê´€ì‹¬ ë§¤ìˆ˜\n\nêµ¬ì²´ì  ì¡°ì–¸: ì•„ì§ ë³¸ê²©ì ì¸ ìƒìŠ¹ì€ ì•„ë‹ˆì§€ë§Œ, ëª¨ë©˜í…€ì´ í˜•ì„±ë˜ê³  ìžˆìŠµë‹ˆë‹¤. ì†ŒëŸ‰ ë¶„í•  ë§¤ìˆ˜ë¡œ ì ‘ê·¼í•˜ì„¸ìš”.`,
      negative_high: `ðŸ’¨ ë„ë§ì¹˜ì„¸ìš”! ${stockName}ì´ í­ë½í•˜ê³  ìžˆìŠµë‹ˆë‹¤!\n\ní˜„ìž¬ ìƒí™©: ${Math.abs(changeRate).toFixed(2)}%ì˜ ê¸‰ê²©í•œ í•˜ë½! ë–¨ì–´ì§€ëŠ” ì¹¼ë‚ ì„ ìž¡ì§€ ë§ˆì„¸ìš”.\n\nì¶”ì²œ: ì¦‰ì‹œ ë§¤ë„ âš ï¸\n\nêµ¬ì²´ì  ì¡°ì–¸: í•˜ë½ ì¶”ì„¸ëŠ” ë¬´ì„­ìŠµë‹ˆë‹¤. ì†ì ˆì´ ë‹µìž…ë‹ˆë‹¤. ë” ë–¨ì–´ì§€ê¸° ì „ì— ë¹ ì ¸ë‚˜ì˜¤ì„¸ìš”!`,
      negative_low: `ðŸ“‰ ${stockName}ì˜ í•˜ë½ì´ ì‹œìž‘ë˜ì—ˆë„¤ìš”. ì¡°ì‹¬í•˜ì„¸ìš”.\n\ní˜„ìž¬ ìƒí™©: ${Math.abs(changeRate).toFixed(2)}%ì˜ í•˜ë½ì´ ê´€ì¸¡ë©ë‹ˆë‹¤.\n\nì¶”ì²œ: ê´€ë§\n\nêµ¬ì²´ì  ì¡°ì–¸: ì¶”ì„¸ê°€ í™•ì‹¤í•´ì§ˆ ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ì„¸ìš”. ì„±ê¸‰í•œ ë§¤ìˆ˜ëŠ” ê¸ˆë¬¼ìž…ë‹ˆë‹¤.`,
      neutral: `ðŸ˜ ${stockName}ì˜ ì¶”ì„¸ê°€ ë¶ˆë¶„ëª…í•©ë‹ˆë‹¤.\n\ní˜„ìž¬ ìƒí™©: íš¡ë³´ êµ¬ê°„ì—ì„œ ë°©í–¥ì„±ì„ ì°¾ê³  ìžˆìŠµë‹ˆë‹¤.\n\nì¶”ì²œ: ëŒ€ê¸°\n\nêµ¬ì²´ì  ì¡°ì–¸: ëª…í™•í•œ ì‹ í˜¸ê°€ ë‚˜ì˜¬ ë•Œê¹Œì§€ ê´€ë§í•˜ëŠ” ê²Œ ìµœì„ ìž…ë‹ˆë‹¤. ì¸ë‚´ì‹¬ì„ ê°€ì§€ì„¸ìš”.`
    },
    value: {
      positive_high: `âš ï¸ ${stockName}ì´ ê³¼ì—´ êµ¬ê°„ì— ì§„ìž…í–ˆìŠµë‹ˆë‹¤.\n\ní˜„ìž¬ ìƒí™©: ${Math.abs(changeRate).toFixed(2)}%ì˜ ê¸‰ë“±ì€ ë¹„ì´ì„±ì  ì—´ê´‘ì˜ ì§•í›„ìž…ë‹ˆë‹¤.\n\nì¶”ì²œ: ì´ìµ ì‹¤í˜„ ë§¤ë„\n\nêµ¬ì²´ì  ì¡°ì–¸: ì‹œìž¥ì´ í™˜í¬ì— ë¹ ì¡Œì„ ë•Œê°€ ë°”ë¡œ ë§¤ë„ íƒ€ì´ë°ìž…ë‹ˆë‹¤. ëƒ‰ì •í•¨ì„ ìœ ì§€í•˜ê³  ìˆ˜ìµì„ í™•ì •í•˜ì„¸ìš”. íƒìš•ì€ ê¸ˆë¬¼ìž…ë‹ˆë‹¤.`,
      positive_low: `ðŸ“Š ${stockName}ì´ ì ì • ê°€ê²©ëŒ€ë¥¼ í–¥í•´ ê°€ê³  ìžˆìŠµë‹ˆë‹¤.\n\ní˜„ìž¬ ìƒí™©: ${Math.abs(changeRate).toFixed(2)}%ì˜ ì™„ë§Œí•œ ìƒìŠ¹ì€ ìžì—°ìŠ¤ëŸ¬ìš´ íë¦„ìž…ë‹ˆë‹¤.\n\nì¶”ì²œ: ë³´ìœ  ìœ ì§€\n\nêµ¬ì²´ì  ì¡°ì–¸: ê¸°ì—…ì˜ ë‚´ìž¬ ê°€ì¹˜ëŠ” ë³€í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ìž¥ê¸°ì  ê´€ì ì„ ìœ ì§€í•˜ì„¸ìš”.`,
      negative_high: `ðŸ’Ž ë°”ê²ì„¸ì¼ìž…ë‹ˆë‹¤! ${stockName}ì´ ë§¤ë ¥ì ì¸ ê°€ê²©ëŒ€ì— ì§„ìž…í–ˆìŠµë‹ˆë‹¤!\n\ní˜„ìž¬ ìƒí™©: ${Math.abs(changeRate).toFixed(2)}%ì˜ ê¸‰ë½ì€ ê³µí¬ ë§¤ë¬¼ì´ ìŸì•„ì§„ ê²°ê³¼ìž…ë‹ˆë‹¤.\n\nì¶”ì²œ: ê°•ë ¥ ë§¤ìˆ˜ ê¸°íšŒ ðŸ’°\n\nêµ¬ì²´ì  ì¡°ì–¸: ë‹¤ë¥¸ ì‚¬ëžŒë“¤ì´ ë‘ë ¤ì›Œí•  ë•Œê°€ ë°”ë¡œ ë§¤ìˆ˜ íƒ€ì´ë°ìž…ë‹ˆë‹¤. ì´ ê°€ê²©ì€ ì˜¤ëž˜ ê°€ì§€ ì•ŠìŠµë‹ˆë‹¤. ë¶„í•  ë§¤ìˆ˜ë¡œ ì¡°ê¸ˆì”© ë‹´ìœ¼ì„¸ìš”!`,
      negative_low: `ðŸŽ¯ ${stockName}ì´ í•©ë¦¬ì ì¸ ê°€ê²©ëŒ€ë¡œ ë‚´ë ¤ì˜¤ê³  ìžˆìŠµë‹ˆë‹¤.\n\ní˜„ìž¬ ìƒí™©: ${Math.abs(changeRate).toFixed(2)}%ì˜ ì¡°ì •ì€ ì¢‹ì€ ë§¤ìˆ˜ ê¸°íšŒê°€ ë  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.\n\nì¶”ì²œ: ë¶„í•  ë§¤ìˆ˜\n\nêµ¬ì²´ì  ì¡°ì–¸: ì²œì²œížˆ ì¡°ê¸ˆì”© ëª¨ì•„ê°€ì„¸ìš”. ì„œë‘ë¥¼ í•„ìš” ì—†ìŠµë‹ˆë‹¤. ê¸°ì—…ì˜ íŽ€ë”ë©˜í„¸ì„ ë¯¿ìœ¼ì„¸ìš”.`,
      neutral: `âš–ï¸ ${stockName}ì€ í˜„ìž¬ ì ì • ê°€ê²©ëŒ€ë¥¼ ìœ ì§€í•˜ê³  ìžˆìŠµë‹ˆë‹¤.\n\ní˜„ìž¬ ìƒí™©: í° ë³€ë™ ì—†ì´ ì•ˆì •ì ìž…ë‹ˆë‹¤.\n\nì¶”ì²œ: í˜„ ìƒíƒœ ìœ ì§€\n\nêµ¬ì²´ì  ì¡°ì–¸: ê°€ì¹˜ íˆ¬ìžìžëŠ” ì¸ë‚´ì‹¬ì´ í•„ìš”í•©ë‹ˆë‹¤. ê¸°ì—…ì˜ ë³¸ì§ˆì  ê°€ì¹˜ëŠ” ë‹¨ê¸° ì£¼ê°€ì— í”ë“¤ë¦¬ì§€ ì•ŠìŠµë‹ˆë‹¤.`
    },
    timid: {
      positive_high: `ðŸ˜° ${stockName}ì´ ë„ˆë¬´ ë§Žì´ ì˜¬ëžì–´ìš”! ë¬´ì„œì›Œìš”!\n\ní˜„ìž¬ ìƒí™©: ${Math.abs(changeRate).toFixed(2)}%ë‚˜ ì˜¬ëžëŠ”ë°... ì´ëŸ¬ë‹¤ ë–¨ì–´ì§€ë©´ ì–´ë–¡í•˜ì£ ?\n\nì¶”ì²œ: ì¼ë¶€ ë§¤ë„í•´ì„œ ì•ˆì „í•˜ê²Œ...\n\nêµ¬ì²´ì  ì¡°ì–¸: ì˜¤, ì¡°ê¸ˆ ë²Œì—ˆë„¤ìš”? ì§€ê¸ˆ íŒ”ì•„ì„œ í™•ì • ì§“ëŠ” ê²Œ ë§ˆìŒì´ íŽ¸í•  ê²ƒ ê°™ì•„ìš”. ë³€ë™ì„±ì´ ë„ˆë¬´ ì»¤ì„œ ìž ë„ ëª» ìž˜ ê²ƒ ê°™ì•„ìš” ã… ã… `,
      positive_low: `ðŸ˜Œ ${stockName}ì´ ì¡°ê¸ˆ ì˜¬ëžë„¤ìš”. ë‹¤í–‰ì´ì—ìš”.\n\ní˜„ìž¬ ìƒí™©: ${Math.abs(changeRate).toFixed(2)}% ì •ë„ë©´ ì ë‹¹í•œ ê²ƒ ê°™ì•„ìš”.\n\nì¶”ì²œ: ê·¸ëƒ¥ ë³´ìœ í• ê¹Œìš”..?\n\nêµ¬ì²´ì  ì¡°ì–¸: ì´ ì •ë„ ìˆ˜ìµì´ë©´ íŒ”ê¹Œ ë§ê¹Œ ê³ ë¯¼ë˜ë„¤ìš”. ë” ì˜¤ë¥¼ ìˆ˜ë„ ìžˆì§€ë§Œ... ë–¨ì–´ì§ˆ ìˆ˜ë„ ìžˆê³ ... ì–´ë–»ê²Œ í•´ì•¼ í• ê¹Œìš”? ðŸ˜¥`,
      negative_high: `ðŸ˜± ìœ¼ì•…! ${stockName}ì´ í­ë½í•˜ê³  ìžˆì–´ìš”!\n\ní˜„ìž¬ ìƒí™©: ${Math.abs(changeRate).toFixed(2)}%ë‚˜ ë–¨ì–´ì¡Œì–´ìš”! ì†í•´ê°€ ë„ˆë¬´ ì»¤ìš”!\n\nì¶”ì²œ: ì–´ë–¡í•˜ì£ ... íŒ”ì•„ì•¼ í•˜ë‚˜ìš”?\n\nêµ¬ì²´ì  ì¡°ì–¸: ì†í•´ ë³´ê³  ìžˆì–´ìš”... íŒ”ë©´ ì†ì‹¤ í™•ì •ì´ê³ , ì•ˆ íŒ”ë©´ ë” ë–¨ì–´ì§ˆ ê²ƒ ê°™ê³ ... ì›ê¸ˆ ê±±ì •ë¼ì„œ ìž ë„ ëª» ìžê² ì–´ìš” ã… ã… ã… `,
      negative_low: `ðŸ˜Ÿ ${stockName}ì´ ì¡°ê¸ˆ ë–¨ì–´ì¡Œì–´ìš”. ê±±ì •ë¼ìš”.\n\ní˜„ìž¬ ìƒí™©: ${Math.abs(changeRate).toFixed(2)}% í•˜ë½... ë” ë–¨ì–´ì§ˆê¹Œë´ ë¬´ì„œì›Œìš”.\n\nì¶”ì²œ: ì¼ë‹¨ ì§€ì¼œë³¼ê¹Œìš”...\n\nêµ¬ì²´ì  ì¡°ì–¸: ì†í•´ê°€ ì»¤ì§€ê¸° ì „ì— ë¹ ì ¸ë‚˜ì˜¬ê¹Œìš”? ì•„ë‹ˆë©´ íšŒë³µë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦´ê¹Œìš”? íŒë‹¨ì´ ì•ˆ ì„œìš”... ðŸ˜¢`,
      neutral: `ðŸ˜Š ${stockName}ì´ ì¡°ìš©í•˜ë„¤ìš”. ì¢‹ì•„ìš”.\n\ní˜„ìž¬ ìƒí™©: í° ë³€ë™ì´ ì—†ì–´ì„œ ë§ˆìŒì´ íŽ¸í•©ë‹ˆë‹¤.\n\nì¶”ì²œ: ì´ëŒ€ë¡œ ìœ ì§€\n\nêµ¬ì²´ì  ì¡°ì–¸: ì¡°ìš©í•´ì„œ ì¢‹ë„¤ìš”. ì´ëŒ€ë¡œë§Œ ê°‘ì‹œë‹¤. ë³€ë™ì„± ì‹«ì–´ìš”. ì›ê¸ˆë§Œ ì§€ì¼œì§€ë©´ ë©ë‹ˆë‹¤...`
    }
  };

  const personaTemplates = templates[persona];
  if (!personaTemplates) return "ë¶„ì„ì„ ìƒì„±í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";

  if (changeRate > 5) return personaTemplates.positive_high;
  if (changeRate > 0) return personaTemplates.positive_low;
  if (changeRate < -5) return personaTemplates.negative_high;
  if (changeRate < 0) return personaTemplates.negative_low;
  return personaTemplates.neutral;
};

// ë‰´ìŠ¤ í—¤ë“œë¼ì¸ í…œí”Œë¦¿
export const generateNewsHeadline = (stockName, changeRate) => {
  const headlines = {
    positive_high: [
      `ðŸš€ ${stockName} ê¸‰ë“±! íˆ¬ìžìžë“¤ í™˜í˜¸ì„± "ë‹¤ìŒ í…ŒìŠ¬ë¼ íƒ„ìƒ?"`,
      `ðŸ“ˆ ${stockName}, í•˜ë£¨ ë§Œì— ${Math.abs(changeRate).toFixed(1)}% í­ë“±! ì‹œìž¥ ë“¤ì©`,
      `ðŸ”¥ ${stockName} ìƒí•œê°€ ê·¼ì ‘! "ì§€ê¸ˆì´ ë§ˆì§€ë§‰ ê¸°íšŒ" ì „ë¬¸ê°€ í•œëª©ì†Œë¦¬`,
      `ðŸ’° ${stockName} ëŒí’! ê°œë¯¸íˆ¬ìžìžë“¤ ëŒ€ë°• í–‰ì§„`,
      `âš¡ ${stockName} ê¸‰ë“±ì— ì¦ê¶Œê°€ ê¸´ê¸‰ë¶„ì„ "ë°¸ë¥˜ì—ì´ì…˜ ìž¬í‰ê°€ ì‹œìž‘"`,
    ],
    positive_low: [
      `ðŸ“Š ${stockName}, ì™„ë§Œí•œ ìƒìŠ¹ì„¸ ì§€ì†... ì•ˆì •ì  ìˆ˜ìµ ê¸°ëŒ€`,
      `âœ… ${stockName} ê¾¸ì¤€í•œ ìƒìŠ¹ "ìž¥ê¸° íˆ¬ìž ë§¤ë ¥ë„ UP"`,
      `ðŸŽ¯ ${stockName}, ì¡°ìš©í•œ ê°•ì„¸... ì €í‰ê°€ ë…¼ëž€`,
      `ðŸ“ˆ ${stockName} ë‹¨ê³„ì  ìƒìŠ¹, ì „ë¬¸ê°€ "ê±´ì „í•œ ìƒìŠ¹ì„¸"`,
    ],
    negative_high: [
      `ðŸ’¥ ${stockName} ${Math.abs(changeRate).toFixed(1)}% ê¸‰ë½! ë¬´ìŠ¨ ì¼ì´?`,
      `âš ï¸ ${stockName} í­ë½ì— ì‹œìž¥ íŒ¨ë‹‰ "ì†ì ˆ ëŸ¬ì‹œ"`,
      `ðŸ˜± ${stockName} ì¶”ë½... ê°œë¯¸íˆ¬ìžìž "ë©˜ë¶•"`,
      `ðŸ“‰ ${stockName} ì•…ìž¬ì— ì§ê²©íƒ„! ê¸‰ë§¤ë¬¼ ìŸì•„ì ¸`,
      `ðŸ”´ ${stockName} ê¸‰ë½ "ë²„ë¸” ë¶•ê´´ ì‹œìž‘?" ìš°ë ¤ í™•ì‚°`,
    ],
    negative_low: [
      `ðŸ“‰ ${stockName} í•˜ë½ì„¸... íˆ¬ìžì‹¬ë¦¬ ìœ„ì¶•`,
      `ðŸ˜Ÿ ${stockName}, ì¡°ì • êµ­ë©´ ì§„ìž… "ì €ê°€ ë§¤ìˆ˜ ê¸°íšŒ?"`,
      `â¬‡ï¸ ${stockName} ì†Œí­ í•˜ë½, ì‹œìž¥ "ê´€ë§ì„¸ ìš°ì„¸"`,
      `ðŸ“Š ${stockName} ì•½ì„¸ ì§€ì†... ë°˜ë“± ì‹œì ì€?`,
    ],
    neutral: [
      `ðŸ˜ ${stockName} ë³´í•©ì„¸... ë°©í–¥ì„± ì°¾ê¸° ì¤‘`,
      `ðŸ“Š ${stockName} íš¡ë³´ìž¥ ì§€ì† "ê¸°ë‹¤ë¦¼ì˜ ë¯¸í•™"`,
      `âš–ï¸ ${stockName} ê· í˜• ìœ ì§€... ë‹¤ìŒ ì›€ì§ìž„ì— ì£¼ëª©`,
      `ðŸ” ${stockName} ë³€ë™ì„± ì¶•ì†Œ, ì‹œìž¥ "ìˆ¨ê³ ë¥´ê¸°"`,
    ],
  };

  let category;
  if (changeRate > 5) category = 'positive_high';
  else if (changeRate > 0) category = 'positive_low';
  else if (changeRate < -5) category = 'negative_high';
  else if (changeRate < 0) category = 'negative_low';
  else category = 'neutral';

  const options = headlines[category];
  const randomIndex = Math.floor(Math.random() * options.length);
  return options[randomIndex];
};

